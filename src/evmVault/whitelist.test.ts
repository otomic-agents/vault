import { Whitelist } from './whitelist';
import { Transaction } from 'ethers';

describe('Whitelist', () => {
    it('should allow a transaction that meets the whitelist rules', () => {
        const whitelist = new Whitelist();

        let serializedTx =
            '0xf86a8085012a05f200830186a09455d398326f99059ff775485246999027b319795580b844095ea7b30000000000000000000000006f12fed6cd5bebfa3351c447f7873b76178b1b840000000000000000000000000000000000000000000000056bc75e2d63100000388080';
        let tx = Transaction.from(serializedTx);

        let requestIp = '192.168.0.1';
        let isValid = whitelist.isAllowedTx(requestIp, tx);
        expect(isValid).toBe(true);
    });

    it('should allow a transaction that meets the whitelist rules', () => {
        const whitelist = new Whitelist();

        let serializedTx =
            '0xf901a9038317d1038301ade5946f12fed6cd5bebfa3351c447f7873b76178b1b8480b90184de8ecd4e00000000000000000000000053d9736fc09b172afca982eedacc0dda7796811e00000000000000000000000028623bf8e872ffae6e2955a176dfcd10b97a09b30000000000000000000000004200000000000000000000000000000000000006000000000000000000000000000000000000000000000000000e24eaabf7300000000000000000000000000000000000000000000000000000000000000000006fe944baef57d0bf37082c16b5e3b5498a51a59e11822a10ad2aa455ff0ec266000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000007800000000000000000000000000000000000000000000000000000000675bebf700000000000000000000000000000000000000000000000000000000000001f5d4e0520ed40ddea6545d999c494cd0e47e326e383cb7f1b20bbc09658ff64b3800000000000000000000000000000000000000000000000000000000675be9da0a8080';
        let tx = Transaction.from(serializedTx);

        let requestIp = '192.168.0.1';
        let isValid = whitelist.isAllowedTx(requestIp, tx);
        expect(isValid).toBe(true);
    });
});
